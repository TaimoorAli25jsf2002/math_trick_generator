<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Mind Trick Generator — Random Whole-Number Tricks</title>
<style>
  :root{
    --bg:#fbfbfb;
    --card:#fff;
    --muted:#6b7280;
    --borderA:#0b1220;
    --borderB:#374151;
    --accent:#111827;
    --radius:12px;
    --gap:14px;
    --maxw:1200px;
  }
  *{box-sizing:border-box}
  body{
    margin:0;
    font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
    background:var(--bg);
    color:var(--accent);
    padding:32px;
    display:flex;
    justify-content:center;
  }
  .wrap{width:100%;max-width:var(--maxw)}
  header{display:flex;align-items:center;gap:14px;margin-bottom:18px}
  .logo{width:56px;height:56px;border-radius:10px;background:linear-gradient(180deg,#fff,#f3f4f6);display:flex;align-items:center;justify-content:center;font-weight:700;color:var(--accent);border:1px solid rgba(0,0,0,0.06)}
  h1{margin:0;font-size:20px}
  .lead{margin:0;color:var(--muted);font-size:13px}
  .controls{display:flex;gap:10px;align-items:center;margin:18px 0;flex-wrap:wrap}
  input[type="number"], input[type="text"]{padding:10px 12px;border-radius:10px;border:1px solid rgba(15,23,42,0.06);background:white;font-size:14px}
  button.btn{padding:10px 12px;border-radius:10px;border:0;background:linear-gradient(90deg,var(--borderA),var(--borderB));color:white;font-weight:600;cursor:pointer}
  button.ghost{background:transparent;border:1px solid rgba(15,23,42,0.06);padding:9px 12px;border-radius:10px;cursor:pointer}
  .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:var(--gap)}
  .card{background:var(--card);border-radius:var(--radius);padding:14px;position:relative;box-shadow:0 6px 14px rgba(15,23,42,0.04);transition:transform .16s ease,box-shadow .16s ease;border:1px solid transparent;
    -webkit-mask: linear-gradient(#fff,#fff) padding-box, linear-gradient(90deg,var(--borderA),var(--borderB)) border-box;
    mask: linear-gradient(#fff,#fff) padding-box, linear-gradient(90deg,var(--borderA),var(--borderB)) border-box;
  }
  .card:hover{transform:translateY(-6px);box-shadow:0 18px 40px rgba(15,23,42,0.06)}
  .hdr{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
  .num{font-weight:700;color:var(--accent)}
  .steps{font-size:14px;color:var(--accent);line-height:1.45;margin-bottom:10px}
  .step{display:flex;gap:10px;align-items:flex-start;margin:6px 0}
  .dot{width:26px;height:26;border-radius:6px;background:#111;color:white;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:13px}
  .meta{display:flex;justify-content:space-between;align-items:center;margin-top:8px;gap:8px}
  .copy{background:transparent;border:0;color:var(--accent);cursor:pointer;font-weight:700}
  .formula{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", monospace;background:#fafafa;padding:8px;border-radius:8px;border:1px solid rgba(0,0,0,0.03);font-size:13px}
  footer{margin-top:22px;color:var(--muted);font-size:13px;text-align:center}
  .controls-left{display:flex;gap:8px;align-items:center}
  .controls-right{margin-left:auto;display:flex;gap:8px;align-items:center}
  .small{width:110px}
  .note{font-size:13px;color:var(--muted)}
  @media (max-width:920px){.controls{flex-direction:column;align-items:stretch}.controls-right{margin-left:0}}
</style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="logo">TM</div>
      <div>
        <h1>Mind Trick Generator — Random Whole-Number Tricks</h1>
        <p class="lead">Generate N unique tricks. All subtract steps are whole numbers. Each card shows steps and the reverse formula.</p>
      </div>
    </header>

    <div class="controls">
      <div class="controls-left">
        <label class="note" for="count">How many tricks</label>
        <input id="count" type="number" min="1" max="500" value="20" class="small" />
        <label class="note" for="minM" style="margin-left:8px">M range</label>
        <input id="minM" type="number" min="2" value="2" style="width:68px" />
        <input id="maxM" type="number" min="2" value="10" style="width:68px" />
        <label class="note" style="margin-left:8px">D range</label>
        <input id="minD" type="number" min="2" value="2" style="width:68px" />
        <input id="maxD" type="number" min="2" value="10" style="width:68px" />
      </div>

      <div class="controls-right">
        <button class="btn" id="generateBtn">Generate</button>
        <button class="ghost" id="shuffleBtn">Shuffle Cards</button>
        <button class="ghost" id="clearBtn">Clear</button>
      </div>
    </div>

    <main>
      <div class="grid" id="grid"></div>
    </main>

    <footer>All tricks are reversible. Hidden formula = how to compute original from final. © 2025</footer>
  </div>

<!-- Try modal (reusable) -->
<div id="popup" style="display:none;position:fixed;inset:0;align-items:center;justify-content:center;background:rgba(0,0,0,0.35);z-index:999">
  <div style="background:white;padding:18px;border-radius:10px;max-width:420px;width:92%;box-shadow:0 20px 40px rgba(0,0,0,0.12);">
    <div id="popupCounter" style="color:#6b7280;margin-bottom:8px"></div>
    <div id="popupStepText" style="font-size:16px;margin-bottom:12px"></div>
    <div style="display:flex;gap:8px;justify-content:center">
      <button id="popupClose" style="padding:8px 12px;border-radius:8px;border:0;background:#eef2ff;color:#111;cursor:pointer">Close</button>
    </div>
  </div>
</div>

<script>
/* Utilities */
function randInt(min, max) {
  return Math.floor(Math.random() * (max - min + 1)) + min;
}
function shuffleArray(a) {
  for (let i = a.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [a[i], a[j]] = [a[j], a[i]];
  }
}

/* Build a single whole-number trick
   - choose order randomly ("multiply" or "add")
   - pick M within [minM, maxM], D within [minD, maxD]
   - choose small integer c (1..12) and set A = D * c so A/D = c (integer)
   - For multiply-first: steps = ×M, +A, ÷D, −c
   - For add-first: steps = +A, ×M, ÷D, −(M*c)  (since (M*A)/D = M*c)
   - Show hidden formula: Final = (M/D)*x  (because we cancel constants)
     so original = Final ÷ (M/D)
*/
function makeTrick(minM, maxM, minD, maxD) {
  const order = Math.random() < 0.5 ? 'multiply' : 'add';
  const M = randInt(minM, maxM);
  const D = randInt(minD, maxD);
  // choose c small integer but avoid too large A; vary between 1..12
  const c = randInt(1, 12);
  const A = D * c; // ensures whole-number subtract
  let steps, subtractVal, hiddenMultiplier, reverse;
  if (order === 'multiply') {
    subtractVal = c; // A/D
    steps = [
      "Think of a number",
      `Multiply by ${M}`,
      `Add ${A}`,
      `Divide by ${D}`,
      `Subtract ${subtractVal}`
    ];
  } else {
    subtractVal = M * c; // (M*A)/D = M * (A/D) = M*c
    steps = [
      "Think of a number",
      `Add ${A}`,
      `Multiply by ${M}`,
      `Divide by ${D}`,
      `Subtract ${subtractVal}`
    ];
  }
  hiddenMultiplier = M / D; // M ÷ D
  // Format multiplier nicely: if integer show integer else 2 decimals
  const hmStr = Number.isInteger(hiddenMultiplier) ? String(hiddenMultiplier) : (Math.round(hiddenMultiplier*100)/100).toFixed(2).replace(/\.?0+$/, '');
  reverse = `Original = Final ÷ (${M} ÷ ${D}) = Final ÷ ${hmStr}`;
  return {
    order, M, A, D, c, steps, subtractVal, hiddenMultiplier, reverse
  };
}

/* UI rendering */
const grid = document.getElementById('grid');
const generateBtn = document.getElementById('generateBtn');
const shuffleBtn = document.getElementById('shuffleBtn');
const clearBtn = document.getElementById('clearBtn');

function renderTricks(tricks) {
  grid.innerHTML = '';
  tricks.forEach((t, i) => {
    const card = document.createElement('article');
    card.className = 'card';

    const hdr = document.createElement('div'); hdr.className = 'hdr';
    const num = document.createElement('div'); num.className = 'num'; num.textContent = `Trick #${i+1}`;
    hdr.appendChild(num);

    const stepsDiv = document.createElement('div'); stepsDiv.className = 'steps';
    t.steps.forEach((s, idx) => {
      const row = document.createElement('div'); row.className = 'step';
      const dot = document.createElement('div'); dot.className = 'dot'; dot.textContent = idx+1;
      const txt = document.createElement('div'); txt.textContent = s;
      row.appendChild(dot); row.appendChild(txt); stepsDiv.appendChild(row);
    });

    const formulaDiv = document.createElement('div');
    formulaDiv.className = 'formula';
    formulaDiv.textContent = t.reverse;

    const meta = document.createElement('div'); meta.className = 'meta';
    const copyBtn = document.createElement('button'); copyBtn.className = 'copy'; copyBtn.textContent = 'Copy';
    const tryBtn = document.createElement('button'); tryBtn.className = 'copy'; tryBtn.textContent = 'Try';

    // event handlers
    copyBtn.addEventListener('click', (e) => {
      e.stopPropagation();
      const text = t.steps.join(' → ') + '\n' + t.reverse;
      navigator.clipboard.writeText(text).catch(()=>{});
      copyBtn.textContent = 'Copied!';
      setTimeout(()=> copyBtn.textContent = 'Copy', 900);
    });

    tryBtn.addEventListener('click', (e) => {
      e.stopPropagation();
      openTryModal(t.steps);
    });

    meta.appendChild(copyBtn);
    meta.appendChild(tryBtn);

    card.appendChild(hdr);
    card.appendChild(stepsDiv);
    card.appendChild(formulaDiv);
    card.appendChild(meta);

    grid.appendChild(card);
  });
}

/* modal try */
const popup = document.getElementById('popup');
const popupStepText = document.getElementById('popupStepText');
const popupCounter = document.getElementById('popupCounter');
const popupClose = document.getElementById('popupClose');

function openTryModal(steps) {
  let idx = 0;
  popup.style.display = 'flex';
  popupCounter.textContent = `Step ${idx+1} of ${steps.length}`;
  popupStepText.textContent = steps[idx];
  popupClose.textContent = 'Next';
  popupClose.onclick = function() {
    idx++;
    if (idx < steps.length) {
      popupCounter.textContent = `Step ${idx+1} of ${steps.length}`;
      popupStepText.textContent = steps[idx];
    } else {
      // finished
      popupCounter.textContent = '';
      popupStepText.textContent = '✅ All steps done — ask the user for their final result.';
      popupClose.textContent = 'Close';
      popupClose.onclick = ()=> { popup.style.display = 'none'; };
    }
  };
}

/* Controls: generate */
generateBtn.addEventListener('click', ()=>{
  const count = Math.max(1, Math.min(500, Number(document.getElementById('count').value) || 20));
  const minM = Math.max(2, Number(document.getElementById('minM').value) || 2);
  const maxM = Math.max(minM, Number(document.getElementById('maxM').value) || 10);
  const minD = Math.max(2, Number(document.getElementById('minD').value) || 2);
  const maxD = Math.max(minD, Number(document.getElementById('maxD').value) || 10);

  const tricks = [];
  const used = new Set();
  // try to create diverse tricks; iterate until we have count or iteration cap
  let attempts = 0;
  while (tricks.length < count && attempts < count * 40) {
    attempts++;
    const M = randInt(minM, maxM);
    const D = randInt(minD, maxD);
    // pick c small 1..12
    const c = randInt(1, 12);
    const A = D * c; // ensures A/D = c integer

    // random order
    const order = Math.random() < 0.5 ? 'multiply' : 'add';
    let steps, subtractVal, reverseStr;
    if (order === 'multiply') {
      subtractVal = c;
      steps = [
        "Think of a number",
        `Multiply by ${M}`,
        `Add ${A}`,
        `Divide by ${D}`,
        `Subtract ${subtractVal}`
      ];
    } else {
      subtractVal = M * c;
      steps = [
        "Think of a number",
        `Add ${A}`,
        `Multiply by ${M}`,
        `Divide by ${D}`,
        `Subtract ${subtractVal}`
      ];
    }
    // key for uniqueness
    const key = `${order}|${M}|${A}|${D}|${subtractVal}`;
    if (used.has(key)) continue;
    used.add(key);
    const hm = M / D;
    const hmStr = Number.isInteger(hm) ? String(hm) : (Math.round(hm*100)/100).toFixed(2).replace(/\.?0+$/,'');
    reverseStr = `Original = Final ÷ (${M} ÷ ${D}) = Final ÷ ${hmStr}`;
    tricks.push({steps, reverse: reverseStr});
  }

  renderTricks(tricks);
});

/* shuffle & clear handlers */
shuffleBtn.addEventListener('click', ()=>{
  // grab current cards info and shuffle by DOM nodes
  const nodes = Array.from(grid.children);
  shuffleArray(nodes);
  grid.innerHTML = '';
  nodes.forEach(n=> grid.appendChild(n));
});

clearBtn.addEventListener('click', ()=> grid.innerHTML = '');

</script>
</body>
</html>
